<!-- @author Aline Shulzhenko -->

<ui:composition
    template="/WEB-INF/templates/master.xhtml"
    xmlns="http://www.w3.org/1999/xhtml"
    xmlns:ui="http://java.sun.com/jsf/facelets"
    xmlns:p="http://primefaces.org/ui"
    xmlns:f="http://xmlns.jcp.org/jsf/core"
    xmlns:h="http://xmlns.jcp.org/jsf/html">

    <f:metadata>
        <f:event type="preRenderView" listener="#{search.onload()}" />
    </f:metadata>

    <ui:define name="placeholder-css"><h:outputStylesheet library="css" name="search-purchasing.css" /></ui:define>

    <ui:define name="windowTitle">#{bundle.search}</ui:define>

    <ui:define name="content">

        <div class="panel-heading">
            <h2 class="text-center a-header">#{bundle.search}</h2>
        </div>

        <!-- Search Options -->
        <div class="panel-body">
            <h:form id="searchForm" class="form-horizontal">   

                <div class="form-group" id="searchGrid">
                    <h:outputLabel for="choice" value="#{bundle.choose_from}" class="control-label col-sm-4"/>     
                    <div class="col-sm-4">
                        <h:selectOneMenu id="choice" value="#{search.choice}" required="true" class="form-control">
                            <f:ajax listener="#{search.onItemSelect()}" render="@all" />
                            <f:selectItem noSelectionOption="true" itemValue="" itemLabel="-- #{bundle.choose_option} --" />
                            <f:selectItems value="#{search.options}" />
                        </h:selectOneMenu>
                    </div>       
                    <h:message class="error" for="searchForm" id="searchFormMessage" />  
                </div>   

                <div class="form-group"  id="keyG">
                    <h:outputLabel  for="key" rendered="#{!search.dateSelected}" value="#{bundle.search_key}" 
                                    class="control-label col-sm-4"/>
                    <div class="col-sm-4">
                        <h:inputText  id="key"  rendered="#{!search.dateSelected}"
                                      value="#{search.key}" required="true" class="form-control"/>
                    </div>
                    <h:message id="keyMessage" class="error" for="key" rendered="#{!search.dateSelected}" />
                </div> 

                <div class="form-group"  id="dateG">
                    <h:outputLabel  for="date"  rendered="#{search.dateSelected}" value="#{bundle.choose_date}" 
                                    class="control-label col-sm-4"/>
                    <div class="col-sm-4">
                        <h:panelGrid columns="2">
                            <p:calendar  id="dateStart"  rendered="#{search.dateSelected}" value="#{search.dateStart}" mode="inline"/>
                            <p:calendar rendered="#{search.dateSelected}" id="dateEnd" value="#{search.dateEnd}" mode="inline"/>
                        </h:panelGrid>
                    </div>
                    <h:message class="error" for="date"  rendered="#{search.dateSelected}"/>
                </div>           

                <div class="text-center">
                    <h:commandButton value="#{bundle.search}!" action="#{search.search()}" class="btn btn-default btn-blue">
                        <f:ajax execute="@form" render="results searchFormMessage keyMessage"/>
                    </h:commandButton>
                </div>

            </h:form>
        </div>
        <hr/>
        <!-- Search results -->
        <div class="container">
            <ui:fragment rendered="#{!search.albumsEmpty}">
                <h3 class="a-header"><h:outputText value="#{bundle.album_list}"></h:outputText></h3>
            </ui:fragment>

            <div class="row">
                <ui:repeat value="#{search.albums}" rendered="#{!search.albumsEmpty}" var="album" varStatus="status">  
                    <div class="col-sm-4 col-xs-12" style="padding:4px;">
                        <h:link outcome="Album.xhtml" includeViewParams="true" style="color:#fff">
                            <f:param name="id" value="#{album.id}"/>
                            <p:graphicImage name="images/covers/#{search.getAlbumCover(album)}" style="width: 100%" class="cover-image"/>
                            <div class="image-overlay text-center">
                                <p><span class="fa fa-chevron-right"></span></p>
                            </div>
                        </h:link>
                    </div>
                </ui:repeat>
            </div>
        </div>

    </ui:define> 
</ui:composition>

