<ui:composition 
    template="/WEB-INF/templates/mgmt_master.xhtml"
    xmlns="http://www.w3.org/1999/xhtml"
    xmlns:ui="http://java.sun.com/jsf/facelets"
    xmlns:p="http://primefaces.org/ui"
    xmlns:f="http://xmlns.jcp.org/jsf/core"
    xmlns:h="http://xmlns.jcp.org/jsf/html"
    xmlns:c="http://xmlns.jcp.org/jsp/jstl/core">

    <ui:define name="windowTitle">
        <h:outputText value="#{bundle.ListAlbumTitle}"></h:outputText>
    </ui:define>

    <ui:define name="placeholder-css">
        <h:outputStylesheet library="css" name="mgmt_crud.css" />
    </ui:define>

    <ui:define name="content">

        <div class="mgmt-content">
            <div class="panel-heading">
                <h1 class="text-center">Album Details</h1>
            </div>
            <div class="panel-body">


                <h:outputText value="nothing selected" rendered="#{empty theAlbums.selectedAlbum}"/>

                <h:form id="form">

                    <h:panelGroup  rendered="#{not theAlbums.editable and not empty theAlbums.selectedAlbum}">

                        <div class="form-group row">
                            <h:outputText value="Id:" class="control-label mgmt_detail_label col-sm-3"/>
                            <h:outputText value="#{theAlbums.selectedAlbum.id}" title="Id"/>
                        </div>
                        <div class="form-group row">
                            <h:outputText value="Title:" class="control-label mgmt_detail_label col-sm-3"/>
                            <h:outputText value="#{theAlbums.selectedAlbum.title}" title="Title"/>
                        </div>
                        <div class="form-group row">
                            <h:outputText value="ReleaseDate:" class="control-label mgmt_detail_label col-sm-3"/>
                            <h:outputText value="#{theAlbums.selectedAlbum.releaseDate}" title="ReleaseDate"/>
                        </div>
                        <div class="form-group row">
                            <h:outputText value="RecordLabel:" class="control-label mgmt_detail_label col-sm-3"/>
                            <h:outputText value="#{theAlbums.selectedAlbum.recordLabel}" title="RecordLabel"/>
                        </div>
                        <div class="form-group row">
                            <h:outputText value="NumTracks:" class="control-label mgmt_detail_label col-sm-3"/>
                            <h:outputText value="#{theAlbums.selectedAlbum.numTracks}" title="NumTracks"/>
                        </div>
                        <div class="form-group row">
                            <h:outputText value="CreatedAt:" class="control-label mgmt_detail_label col-sm-3"/>
                            <h:outputText value="#{theAlbums.selectedAlbum.createdAt}" title="CreatedAt"/> 
                        </div>
                        <div class="form-group row">
                            <h:outputText value="CostPrice:" class="control-label mgmt_detail_label col-sm-3"/>
                            <h:outputText value="#{theAlbums.selectedAlbum.costPrice}" title="CostPrice"/>
                        </div>
                        <div class="form-group row">
                            <h:outputText value="ListPrice:" class="control-label mgmt_detail_label col-sm-3"/>
                            <h:outputText value="#{theAlbums.selectedAlbum.listPrice}" title="ListPrice"/>
                        </div>
                        <div class="form-group row">
                            <h:outputText value="SalePrice:" class="control-label mgmt_detail_label col-sm-3"/>
                            <h:outputText value="#{theAlbums.selectedAlbum.salePrice}" title="SalePrice"/>
                        </div>
                        <div class="form-group row">
                            <h:outputText value="RemovedAt:" class="control-label mgmt_detail_label col-sm-3"/>
                            <h:outputText value="#{theAlbums.selectedAlbum.removedAt}" title="RemovedAt"/>
                        </div>
                        <div class="form-group row">
                            <h:outputText value="Available:" class="control-label mgmt_detail_label col-sm-3"/>
                            <h:outputText value="#{theAlbums.selectedAlbum.available}" title="Available"/>
                        </div>

                        <div class="form-group row">
                            <h:outputText value="Artist:" class="control-label mgmt_detail_label col-sm-3"/>
                            <h:outputText value="#{theAlbums.selectedAlbum.artist.name}" title="Artist"/>
                        </div>

                        <div class="form-group row">
                            <h:outputText value="Tracks:" class="control-label mgmt_detail_label col-sm-3"/>
                            <p:dataTable id="tbl" value="#{theAlbums.selectedAlbum.tracks}" var="item" rows="20" style="width:100px;">
                                <p:column headerText="Id">
                                    <h:outputText value="#{item.id}"/>
                                </p:column>              
                            </p:dataTable>
                        </div>

                        <div class="form-group row">
                            <h:outputText value="Total Sales :"  class="control-label mgmt_detail_label col-sm-3"/>
                            <h:outputText value="#{theAlbums.getTotalSales()}" title="Artist">
                                <f:convertNumber maxFractionDigits="2"/>
                            </h:outputText>
                        </div>



                        <p:commandButton class="mgmt_btn" action="#{theAlbums.makeEditable()}" value="#{bundle.mgmt_btn_edit}" ajax="false"/>                             
                        <p:commandButton class="mgmt_btn" actionListener="#{theAlbums.delete()}" value="#{bundle.mgmt_btn_delete}" update="form">
                            <p:confirm header="Confirmation" message="Are you sure?" icon="ui-icon-alert" />
                        </p:commandButton>

                        <p:confirmDialog global="true" showEffect="fade" hideEffect="fade">
                            <p:commandButton value="Yes" type="button" styleClass="ui-confirmdialog-yes" icon="ui-icon-check" />
                            <p:commandButton value="No" type="button" styleClass="ui-confirmdialog-no" icon="ui-icon-close" />
                        </p:confirmDialog>       

                    </h:panelGroup>

                    <h:panelGrid columns="2" rendered="#{theAlbums.editable and not empty theAlbums.selectedAlbum}">
                        <p:outputLabel value="Id:" for="id" />
                        <p:inputText id="id" value="#{theAlbums.selectedAlbum.id}" title="Id" disabled="true"/>
                        <p:outputLabel value="Title:" for="title" />
                        <p:inputText id="title" value="#{theAlbums.selectedAlbum.title}" title="Title" required="true" requiredMessage="The Title field is required."/>
                        <p:outputLabel value="ReleaseDate:" for="releaseDate" />
                        <p:inputText id="releaseDate" value="#{theAlbums.selectedAlbum.releaseDate}" title="ReleaseDate" disabled="true"/>
                        <p:outputLabel value="RecordLabel:" for="recordLabel" />
                        <p:inputText id="recordLabel" value="#{theAlbums.selectedAlbum.recordLabel}" title="RecordLabel" required="true" requiredMessage="The RecordLabel field is required."/>
                        <p:outputLabel value="NumTracks:" for="numTracks" />
                        <p:inputText id="numTracks" value="#{theAlbums.selectedAlbum.numTracks}" title="NumTracks" required="true" requiredMessage="The NumTracks field is required."/>
                        <p:outputLabel value="CreatedAt:" for="createdAt" />
                        <p:inputText id="createdAt" value="#{theAlbums.selectedAlbum.createdAt}" title="CreatedAt" disabled="true"/>
                        <p:outputLabel value="CostPrice:" for="costPrice" />
                        <p:inputText id="costPrice" value="#{theAlbums.selectedAlbum.costPrice}" title="CostPrice" required="true" requiredMessage="The CostPrice field is required."/>
                        <p:outputLabel value="ListPrice:" for="listPrice" />
                        <p:inputText id="listPrice" value="#{theAlbums.selectedAlbum.listPrice}" title="ListPrice" required="true" requiredMessage="The ListPrice field is required."/>
                        <p:outputLabel value="SalePrice:" for="salePrice" />
                        <p:inputText id="salePrice" value="#{theAlbums.selectedAlbum.salePrice}" title="SalePrice" required="true" requiredMessage="The SalePrice field is required."/>
                        <p:outputLabel value="RemovedAt:" for="removedAt" />
                        <p:inputText id="removedAt" value="#{theAlbums.selectedAlbum.removedAt}" title="RemovedAt" disabled="true"/>
                        <p:outputLabel value="Available:" for="available" />
                        <p:selectBooleanCheckbox id="available" value="#{theAlbums.selectedAlbum.available}" />
                        <p:outputLabel value="Artist:" for="artist" />

                        <p:selectOneMenu id="artist" value="#{theAlbums.selectedAlbum.artist}" converter="#{artistConverter}">
                            <f:selectItems value="#{theArtists.artists}"/>
                            <p:column>
                                <h:outputText value="#{a.name}" />
                            </p:column>
                        </p:selectOneMenu> 
                        
                        <p:commandButton class="mgmt_btn" actionListener="#{theAlbums.edit()}" value="Save" update="form">
                            <p:confirm header="Confirmation" message="Are you sure?" icon="ui-icon-alert" />
                        </p:commandButton>

                        <p:confirmDialog global="true" showEffect="fade" hideEffect="fade">
                            <p:commandButton value="Yes" type="button" styleClass="ui-confirmdialog-yes" icon="ui-icon-check" />
                            <p:commandButton value="No" type="button" styleClass="ui-confirmdialog-no" icon="ui-icon-close" />
                        </p:confirmDialog>   

                        <p:commandButton class="mgmt_btn" action="#{theAlbums.makeUneditable()}" value="#{bundle.mgmt_btn_cancel}" ajax="false"/>

                    </h:panelGrid>

                    <!--si l'artiste n'existe, dialog "voulez vous le creer"
                   release date and artist greyed out because annoying (whole thing still not working yet)
                    -->                
                </h:form>  

                <p:button class="mgmt_btn" value="#{bundle.mgmt_btn_return_list}" outcome="/management/album/albumsList.xhtml"/>
            </div>

        </div>
    </ui:define>
</ui:composition>


